<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ูุธุงู ุงูููููุงุช - ููุญุฉ ุงูุชุญูู</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Cairo', sans-serif;
      background-color: #f1f5f9;
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 220px;
      background-color: #1e293b;
      color: white;
      display: flex;
      flex-direction: column;
      padding: 20px;
    }

    .sidebar h2 {
      text-align: center;
      margin-bottom: 30px;
      font-size: 20px;
      border-bottom: 1px solid #475569;
      padding-bottom: 10px;
    }

    .sidebar a {
      color: white;
      text-decoration: none;
      padding: 12px;
      margin: 5px 0;
      border-radius: 8px;
      transition: 0.3s;
      display: block;
      cursor: pointer;
    }

    .sidebar a:hover,
    .sidebar a.active {
      background-color: #3b82f6;
    }

    .main {
      flex: 1;
      padding: 30px;
    }

    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    .card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
      max-width: 700px;
      /* ุฃุถู ูุฐุง ุงูุณุทุฑ */
      margin: auto;
    }


    .card h3 {
      text-align: center;
      margin-bottom: 20px;
      color: #1e293b;
    }

    label {
      display: block;
      margin-top: 15px;
      margin-bottom: 5px;
      color: #334155;
      font-weight: bold;
    }

    input,
    select,
    textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      font-size: 15px;
    }

    button {
      margin-top: 20px;
      width: 100%;
      background-color: #10b981;
      color: white;
      border: none;
      padding: 12px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.3s;
    }

    button:hover {
      background-color: #059669;
    }

    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
    }

    .dash-card {
      background-color: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      text-align: center;
      font-weight: bold;
      font-size: 16px;
      color: #334155;
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        flex-direction: row;
        justify-content: space-around;
      }

      .sidebar h2 {
        display: none;
      }

      .sidebar a {
        padding: 10px;
        flex: 1;
        text-align: center;
      }

      .main {
        padding: 15px;
      }
    }

    #dailyList {
      display: none;
      /* ูุฎูู ุงูุชุฑุงุถููุง */
      justify-content: center;
    }

    #dailyList.active {
      display: flex;
      /* ูุธูุฑ ููุท ููุง ูููู Active */
    }
  </style>
</head>

<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>๐ ููุญุฉ ุงูุชุญูู</h2>
    <a class="nav-link active" data-target="home">๐ ุงูุฑุฆูุณูุฉ</a>
    <a class="nav-link" data-target="offices">๐ข ุงูููุงุชุจ</a>
    <a class="nav-link" data-target="daily">๐ ุชุณุฌูู ููููุฉ ุฌุฏูุฏุฉ</a>
    <a class="nav-link" data-target="dailyList">๐ ุงูููููุงุช</a>
    <a class="nav-link" data-target="newDiscount">โ ุชุณุฌูู ุฎุตู ุฌุฏูุฏ</a>
    <a class="nav-link" data-target="discounts">๐ธ ุงูุฎุตููุงุช</a>
    <a class="nav-link" data-target="newBonus">๐ ุชุณุฌูู ุจููุต ุฌุฏูุฏ</a>
    <a class="nav-link" data-target="bonus">๐ ุงูุจููุต</a>
  </div>

  <!-- Main Content -->
  <div class="main">

    <!-- ุงูุฑุฆูุณูุฉ -->
    <div id="home" class="section active">
      <div class="card">
        <h3>ูุฑุญุจูุง ุจู ูู ุงููุธุงู</h3>
        <div class="dashboard-cards">
          <div class="dash-card" id="totalDailyCard">ุฅุฌูุงูู ุงูููููุงุช: 0</div>
          <div class="dash-card">ุฅุฌูุงูู ุงูุฎุตููุงุช: 0</div>
          <div class="dash-card">ุฅุฌูุงูู ุงูุจููุต: 0</div>
        </div>

        <!-- ููุง ุฌุฏูู ููุฎุต ุงูููุงุชุจ -->
        <h3 style="margin-top:30px; text-align:center;">๐ ููุฎุต ุงูููุงุชุจ</h3>
        <table style="width: 100%; border-collapse: collapse; background-color: #f8fafc; margin-top:20px;">
          <thead>
            <tr style="background-color: #e2e8f0;">
              <th style="padding: 10px;">ุงุณู ุงูููุชุจ</th>
              <th style="padding: 10px;">ุนุฏุฏ ุงูููููุงุช</th>
              <th style="padding: 10px;">ุฅุฌูุงูู ุงูุณุนุฑ</th>
            </tr>
          </thead>
          <tbody id="officeSummaryBody">
            <!-- ุงูุจูุงูุงุช ูุชูุฌู ููุง -->
          </tbody>
        </table>
      </div>
    </div>



    <!-- ุงูููููุงุช -->
    <div id="daily" class="section">
      <div class="card">
        <h3>ุชุณุฌูู ููููุฉ ุฌุฏูุฏุฉ</h3>
        <form id="dailyForm"
          action="https://script.google.com/macros/s/AKfycbzne7RxsXUkaPu048NQmV6FnLolE1JpylNGw4Y6aD5WlQxu8qm7UaZBLmPKffDsK5up/exec"
          method="POST" target="dailyFrame" onsubmit="dailySubmitted()">
          <iframe name="dailyFrame" style="display:none;"></iframe>

          <label>๐ ุงูุชุงุฑูุฎ</label>
          <input type="date" name="date" required>

          <label>๐ค ุงุณู ุงูุณุงุฆู</label>
          <input type="text" name="driver" required>

          <label>๐ ููุงู ุงูุณูุงุฑุฉ</label>
          <input type="text" name="carLocation" required>


          <label>๐ข ุงูููุชุจ</label>
          <select name="office" id="officeDropdown" required>
            <option value="">ุงุฎุชุฑ ุงูููุชุจ</option>
          </select>


          <label>๐ ุณุงุนุงุช ุงูุชุบุทูุฉ</label>
          <select name="coverage" required>
            <option value="">ุงุฎุชุฑ ุงูุชุบุทูุฉ</option>
            <option>ุชุบุทูุฉ 12 ุณุงุนู ุตุจุญ</option>
            <option>ุชุบุทูุฉ 12 ุณุงุนุฉ ููู</option>
            <option>ุชุบุทูุฉ 24 ุณุงุนู</option>
          </select>

          <label>๐ฌ ููุชุจ ุงูุนูู</label>
          <select name="workOffice" required>
            <option value="">ุงุฎุชุฑ ุงูููุชุจ</option>
            <option>ููุชุจ ุดุจุฑุง</option>
            <option>ููุชุจ ุงูุฌุณุฑ</option>
            <option>ููุชุจ ุงููููุฏุณูู</option>
          </select>

          <label>๐ฐ ุงูุณุนุฑ</label>
          <input type="number" name="price" required>

          <label>๐ ููุญูุธุงุช</label>
          <textarea name="notes" rows="3"></textarea>

          <button type="submit">๐พ ุญูุธ ุงูููููุฉ</button>
        </form>
      </div>
    </div>

    <!-- ุงูุฎุตููุงุช -->
    <div id="discounts" class="section">
      <div class="card">
        <h3>ุตูุญุฉ ุงูุฎุตููุงุช (ููุฏ ุงูุฅูุดุงุก)</h3>
        <p>ููุง ูุชูุฏุฑ ุชุถูู ูุชุณุฌู ุงูุฎุตููุงุช ุงูุฎุงุตุฉ ุจุงูุณุงุฆููู.</p>
      </div>
    </div>

    <!-- ุงูุจููุต -->
    <div id="bonus" class="section">
      <div class="card">
        <h3>ุตูุญุฉ ุงูุจููุต (ููุฏ ุงูุฅูุดุงุก)</h3>
        <p>ููุง ูุชูุฏุฑ ุชุณุฌู ุงูุจููุต ูุงูููุงูุขุช ููุณุงุฆููู.</p>
      </div>
    </div>

    <!-- ุงูููุงุชุจ -->
    <div id="offices" class="section">
      <div class="card">
        <h3>ุงูููุงุชุจ</h3>

        <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
          <button onclick="openOfficePopup()"
            style="width: 260px; background-color: #3b82f6; color: white; border: none; padding: 10px; border-radius: 8px; font-size: 15px; cursor: pointer;">โ
            ุฅุถุงูุฉ ููุชุจ</button>
          <input type="text" placeholder="๐ ุงุจุญุซ ุนู ููุชุจ"
            style="width: 360px; padding: 10px; border: 1px solid #ccc; border-radius: 8px; font-size: 15px;" />
        </div>

        <table style="width: 100%; border-collapse: collapse; background-color: #f8fafc;">
          <thead>
            <tr style="background-color: #e2e8f0;">
              <th style="padding: 10px;">#</th>
              <th style="padding: 10px;">ุงุณู ุงููุงูู</th>
              <th style="padding: 10px;">ุงุณู ุงูููุชุจ</th>
              <th style="padding: 10px;">ุงูุนููุงู</th>
              <th style="padding: 10px;">ุงููุงุชู</th>
            </tr>
          </thead>
          <tbody id="officeTableBody">
            <!-- ูุชู ุชุนุจุฆุฉ ุงูุตููู ููุง ุชููุงุฆููุง -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- ุจูุจ ุฃุจ ุฅุถุงูุฉ ููุชุจ -->
    <div id="officePopup"
      style="display: none; position: fixed; top: 0; right: 0; left: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 9999; align-items: center; justify-content: center;">
      <div
        style="background: white; padding: 20px; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; position: relative;">
        <h3 style="text-align: center;">ุฅุถุงูุฉ ููุชุจ</h3>

        <form
          action="https://script.google.com/macros/s/AKfycbwrHnQAT6G3Pw2MHvLtadKRIIkc3f3NcDHbJM-_xZ1mmQ3-wkNCDtttnTQgmn3Qxfwm/exec"
          method="POST" target="submitFrame" onsubmit="officeSubmitted()">
          <label>ุงุณู ุงููุงูู</label>
          <input type="text" name="owner" required />

          <label>ุงุณู ุงูููุชุจ</label>
          <input type="text" name="officeName" required />

          <label>ุงูุนููุงู</label>
          <input type="text" name="address" required />

          <label>ุฑูู ุงููุงุชู</label>
          <input type="text" name="phone" required />

          <button type="submit">๐พ ุญูุธ ุงูููุชุจ</button>
          <button type="button" onclick="closeOfficePopup()" style="background-color: #f87171;">โ
            ุฅุบูุงู</button>
        </form>

        <!-- ุฅุทุงุฑ ูุฎูู ูุชูุงุฏู ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ -->
        <iframe name="submitFrame" style="display: none;"></iframe>
      </div>
    </div>

    <!-- ุชุณุฌูู ุฎุตู ุฌุฏูุฏ -->
    <div id="newDiscount" class="section">
      <div class="card">
        <h3>ุชุณุฌูู ุฎุตู ุฌุฏูุฏ</h3>
        <form id="discountForm">

          <label>๐ ุงูุชุงุฑูุฎ</label>
          <input type="date" name="date" required>

          <label>๐ค ุงุณู ุงูุณุงุฆู</label>
          <input type="text" name="driver" required>

          <label>๐ข ุงุณู ุงูููุชุจ</label>
          <input type="text" name="office" required>

          <label>๐ ุงูููุทูุฉ (ุงูุงุฑูุง)</label>
          <input type="text" name="area" required>

          <label>๐ธ ููุน ุงูุฎุตู</label>
          <select name="discountType" required>
            <option value="">ุงุฎุชุฑ ููุน ุงูุฎุตู</option>
            <option>ุฎุตู ุฑุจุน ุดูุช</option>
            <option>ุฎุตู ูุต ุดูุช</option>
            <option>ุฎุตู ุดูุช ุตุจุงุญู</option>
            <option>ุฎุตู ุดูุช ูุณุงุฆู</option>
            <option>ุฎุตู ุดูุช 24 ุณุงุนุฉ</option>
          </select>

          <label>๐ ุณุจุจ ุงูุฎุตู</label>
          <textarea name="reason" rows="3" required></textarea>

          <button type="submit">๐พ ุญูุธ ุงูุฎุตู</button>
        </form>
      </div>
    </div>

    <!-- ุชุณุฌูู ุจููุต ุฌุฏูุฏ -->
    <div id="newBonus" class="section">
      <div class="card">
        <h3>ุชุณุฌูู ุจููุต ุฌุฏูุฏ</h3>
        <form id="bonusForm">

          <label>๐ ุงูุชุงุฑูุฎ</label>
          <input type="date" name="date" required>

          <label>๐ค ุงุณู ุงูุณุงุฆู</label>
          <input type="text" name="driver" required>

          <label>๐ข ุงุณู ุงูููุชุจ</label>
          <input type="text" name="office" required>

          <label>๐ ุงูููุทูุฉ (ุงูุงุฑูุง)</label>
          <input type="text" name="area" required>

          <label>๐ฐ ูุจูุบ ุงูุจููุต</label>
          <input type="number" name="amount" placeholder="ูุซุงู: 150" required>

          <label>๐ ุณุจุจ ุงูุจููุต</label>
          <textarea name="reason" rows="3" required></textarea>

          <button type="submit">๐พ ุญูุธ ุงูุจููุต</button>
        </form>
      </div>
    </div>

    <!-- ุนุฑุถ ุงูููููุงุช -->
    <div id="dailyList" class="section">
      <div
        style="background:white; padding:20px; border-radius:12px; box-shadow: 0 0 10px rgba(0,0,0,0.05); max-width: 1000px; margin: auto;">
        <h3>๐ ูุงุฆูุฉ ุงูููููุงุช</h3>
        <div id="filters" style="display: flex; gap: 10px; margin-bottom: 10px; justify-content: flex-start;">
  <select id="filterOffice">
    <option value="">ูู ุงูููุงุชุจ</option>
    <!-- ููุนุจููู ุฌุงูุงุณูุฑุจุช -->
  </select>

  <select id="filterWorkOffice">
    <option value="">ูู ููุงุชุจ ุงูุนูู</option>
    <!-- ููุนุจููู ุฌุงูุงุณูุฑุจุช -->
  </select>

<select id="filterNotes" style="padding: 5px; min-width: 150px;">
  <option value="">ุงุฎุชุฑ ููุงุญุธุฉ</option>
  <!-- ุงูุฎูุงุฑุงุช ูุชุชุนุจุฃ ุฌุงูุงุณูุฑุจุช -->
</select>

</div>

        <table style="width: 100%; border-collapse: collapse; background-color: #f8fafc; margin-top:20px;">
          <thead>
            <tr style="background-color: #e2e8f0;">
              <th style="padding: 10px;">#</th>
              <th style="padding: 10px;">ุงูุชุงุฑูุฎ</th>
              <th style="padding: 10px;">ุงูุณุงุฆู</th>
              <th style="padding: 10px;">ููุงู ุงูุณูุงุฑุฉ</th>
              <th style="padding: 10px;">ุงูููุชุจ</th>
              <th style="padding: 10px;">ุงูุชุบุทูุฉ</th>
              <th style="padding: 10px;">ููุชุจ ุงูุนูู</th>
              <th style="padding: 10px;">ุงูุณุนุฑ</th>
              <th style="padding: 10px;">ููุงุญุธุงุช</th>
            </tr>
          </thead>
          <tbody id="dailyTableBody">
            <!-- ุงูุจูุงูุงุช ูุชูุฌู ููุง -->
          </tbody>
        </table>
      </div>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // ุงูุชููู ุจูู ุงูุตูุญุงุช
      const links = document.querySelectorAll(".nav-link");
      const sections = document.querySelectorAll(".section");

      links.forEach(link => {
        link.addEventListener("click", () => {
          links.forEach(l => l.classList.remove("active"));
          link.classList.add("active");

          sections.forEach(sec => {
            sec.classList.remove("active");
            if (sec.id === link.dataset.target) {
              sec.classList.add("active");
              if (sec.id === "offices") loadOffices();
              if (sec.id === "dailyList") loadDailyList();
            }

          });

        });
      });

      // ูุนุงูุฌุฉ ูููุฐุฌ ุงูููููุฉ


      let officeCounter = 1;

      function openOfficePopup() {
        document.getElementById('officePopup').style.display = 'flex';
      }

      function closeOfficePopup() {
        document.getElementById('officePopup').style.display = 'none';
      }



      function loadOffices() {
        const sheetCSVUrl = "https://docs.google.com/spreadsheets/d/1KjpVMc2z4uDw6sAmhpZc3I_ph7zsjZFW2R7v7kzq4-E/export?format=csv";

        fetch(sheetCSVUrl)
          .then(res => res.text())
          .then(csv => {
            const rows = csv.split("\n").slice(1); // ุชุฌุงูู ุงูุตู ุงูุฃูู (ุงูุนูุงููู)
            const tbody = document.getElementById("officeTableBody");
            tbody.innerHTML = "";
            let counter = 1;

            rows.forEach(row => {
              if (!row.trim()) return; // ุชุฌุงูู ุงูุตููู ุงููุงุฑุบุฉ
              const [owner, officeName, address, phone] = row.split(",");

              const tr = document.createElement("tr");
              tr.innerHTML = `
                    <td style="padding: 10px;">${counter++}</td>
                    <td style="padding: 10px;">${owner || ''}</td>
                    <td style="padding: 10px;">${officeName || ''}</td>
                    <td style="padding: 10px;">${address || ''}</td>
                    <td style="padding: 10px;">${phone || ''}</td>
                `;
              tbody.appendChild(tr);
            });
          })
          .catch(err => {
            console.error("โ ูุดู ุชุญููู ุงูููุงุชุจ:", err);
          });
      }

      let allDailyData = [];  // ูุชุบูุฑ ุนุงู ูุชุฎุฒูู ุงูุจูุงูุงุช

function applyFiltersAndRenderTable() {
  const filterOffice = document.getElementById("filterOffice").value;
  const filterWorkOffice = document.getElementById("filterWorkOffice").value;
  const filterNotes = document.getElementById("filterNotes").value.toLowerCase();

  const tbody = document.getElementById("dailyTableBody");
  tbody.innerHTML = "";

  const filteredData = allDailyData.filter(row => {
    const matchesOffice = !filterOffice || row.office === filterOffice;
    const matchesWorkOffice = !filterWorkOffice || row.workOffice === filterWorkOffice;
    const matchesNotes = !filterNotes || (row.notes && row.notes.toLowerCase().includes(filterNotes));
    return matchesOffice && matchesWorkOffice && matchesNotes;
  });

  // ุนุฑุถ ุงูุจูุงูุงุช ุจุนุฏ ุงูุชุตููุฉ
  filteredData.forEach((row, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td style="padding: 10px;">${index + 1}</td>
      <td style="padding: 10px;">${row.date || ''}</td>
      <td style="padding: 10px;">${row.driver || ''}</td>
      <td style="padding: 10px;">${row.carLocation || ''}</td>
      <td style="padding: 10px;">${row.office || ''}</td>
      <td style="padding: 10px;">${row.coverage || ''}</td>
      <td style="padding: 10px;">${row.workOffice || ''}</td>
      <td style="padding: 10px;">${row.price || ''}</td>
      <td style="padding: 10px;">${row.notes || ''}</td>
    `;
    tbody.appendChild(tr);
  });

  updateTotalDailyAmount(filteredData);
}

function loadDailyList() {
  const sheetCSVUrl = "https://script.google.com/macros/s/AKfycbxVOKwY5SsJglGBJRV-uU5wxld2DJJQYLKi_U75pPhwXgIgRZVPieNKB5VBuN2LuJ3h/exec";

  fetch(sheetCSVUrl)
    .then(res => res.json())
    .then(data => {
      allDailyData = data;

      // ุชุนุจุฆุฉ ุงูููุงุชุฑ ูุฑุฉ ูุงุญุฏุฉ ุจุงูููู ุงููุฑูุฏุฉ
      fillFilterOptions("filterOffice", [...new Set(data.map(r => r.office).filter(Boolean))]);
      fillFilterOptions("filterWorkOffice", [...new Set(data.map(r => r.workOffice).filter(Boolean))]);
      fillFilterOptions("filterNotes", [...new Set(data.map(r => r.notes).filter(Boolean))]);

      applyFiltersAndRenderTable();
    })
    .catch(err => console.error("โ ูุดู ุชุญููู ุงูููููุงุช:", err));
}

function fillFilterOptions(selectId, values) {
  const select = document.getElementById(selectId);
  const defaultOption = select.querySelector("option");
  select.innerHTML = "";
  if (defaultOption) select.appendChild(defaultOption);
  values.forEach(val => {
    const option = document.createElement("option");
    option.value = val;
    option.textContent = val;
    select.appendChild(option);
  });
}

document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("filterOffice").addEventListener("change", applyFiltersAndRenderTable);
  document.getElementById("filterWorkOffice").addEventListener("change", applyFiltersAndRenderTable);
  document.getElementById("filterNotes").addEventListener("input", applyFiltersAndRenderTable);

  loadDailyList();
});

document.addEventListener("DOMContentLoaded", () => {
  document.getElementById("filterOffice").addEventListener("change", applyFiltersAndRenderTable);
  document.getElementById("filterWorkOffice").addEventListener("change", applyFiltersAndRenderTable);
  document.getElementById("filterNotes").addEventListener("input", applyFiltersAndRenderTable);

  loadDailyList();  // ูู ุฃูุช ุนุงูุฒ ุชุญูู ุงูุจูุงูุงุช ุฃูู ูุง ุงูุตูุญุฉ ุชูุชุญ
});




      document.getElementById("discountForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData(this);
        const data = {};
        formData.forEach((value, key) => data[key] = value);
        console.log("โ ุฎุตู ุฌุฏูุฏ:", data);

        Swal.fire({
          icon: 'success',
          title: 'ุชู ุงูุญูุธ',
          text: 'โ ุชู ุญูุธ ุงูุฎุตู ุจูุฌุงุญ (ูููุฐุฌ ุชุฌุฑูุจู ููุท)',
        });

        this.reset();
      });

      document.getElementById("bonusForm").addEventListener("submit", function (e) {
        e.preventDefault();

        const formData = new FormData(this);
        const data = {};
        formData.forEach((value, key) => data[key] = value);
        console.log("โ ุจูุงูุงุช ุงูุจููุต:", data);

        Swal.fire({
          icon: 'success',
          title: 'ุชู ุงูุญูุธ',
          text: 'โ ุชู ุญูุธ ุงูุจููุต ุจูุฌุงุญ (ูููุฐุฌ ุชุฌุฑูุจู ููุท)',
        });

        this.reset();
      });

      function officeSubmitted() {
        Swal.fire("โ ุชู ุงูุญูุธ", "ุชู ุฅุฑุณุงู ุงูููุชุจ ุฅูู Google Sheet ุจูุฌุงุญ", "success");
        closeOfficePopup();

        // ุชูุฑูุบ ุงูููุฑู ุจุนุฏ ุงูุฅุฑุณุงู
        setTimeout(() => {
          document.querySelector('#officePopup form').reset();
        }, 500);
      }

      function dailySubmitted() {
        Swal.fire("โ ุชู ุงูุญูุธ", "ุชู ุฅุฑุณุงู ุงูููููุฉ ุฅูู Google Sheet ุจูุฌุงุญ", "success");
        setTimeout(() => {
          document.querySelector('#dailyForm').reset();
        }, 500);
      }


      function loadOfficeDropdown() {
        const sheetCSVUrl = "https://docs.google.com/spreadsheets/d/1KjpVMc2z4uDw6sAmhpZc3I_ph7zsjZFW2R7v7kzq4-E/export?format=csv";

        fetch(sheetCSVUrl)
          .then(res => res.text())
          .then(csv => {
            const rows = csv.split("\n").slice(1); // ุชุฌุงูู ุงูุตู ุงูุฃูู (ุงูุนูุงููู)
            const dropdown = document.getElementById("officeDropdown");
            dropdown.innerHTML = '<option value="">ุงุฎุชุฑ ุงูููุชุจ</option>'; // ุฅุนุงุฏุฉ ุงูุชููุฆุฉ

            rows.forEach(row => {
              if (!row.trim()) return;
              const [owner, officeName] = row.split(",");
              if (officeName) {
                const option = document.createElement("option");
                option.value = officeName.trim();
                option.textContent = officeName.trim();
                dropdown.appendChild(option);
              }
            });
          })
          .catch(err => {
            console.error("โ ูุดู ุชุญููู ูุงุฆูุฉ ุงูููุงุชุจ:", err);
          });
      }

      // ุชุญููู ูุงุฆูุฉ ุงูููุงุชุจ ุจูุฌุฑุฏ ูุชุญ ุงูุตูุญุฉ
      document.addEventListener("DOMContentLoaded", loadOfficeDropdown);


      function loadTotalDailyAmount() {
        const dailyApiUrl = "https://script.google.com/macros/s/AKfycbxVOKwY5SsJglGBJRV-uU5wxld2DJJQYLKi_U75pPhwXgIgRZVPieNKB5VBuN2LuJ3h/exec";

        fetch(dailyApiUrl)
          .then(res => res.json())
          .then(data => {
            let totalAmount = 0;

            data.forEach(row => {
              let price = parseFloat(row.price) || 0;
              totalAmount += price;
            });

            document.getElementById("totalDailyAmount").textContent = `ุฅุฌูุงูู ุงูููููุงุช: ${totalAmount} ุฌ.ู`;
          })
          .catch(err => {
            console.error("โ ูุดู ุชุญููู ุฅุฌูุงูู ุงูููููุงุช:", err);
          });
      }

      function loadOfficeSummary() {
        const dailyApiUrl = "https://script.google.com/macros/s/AKfycbxVOKwY5SsJglGBJRV-uU5wxld2DJJQYLKi_U75pPhwXgIgRZVPieNKB5VBuN2LuJ3h/exec";

        fetch(dailyApiUrl)
          .then(res => res.json())
          .then(data => {
            let officeStats = {};

            data.forEach(row => {
              let officeName = row.office || "ุบูุฑ ูุญุฏุฏ";
              let price = parseFloat(row.price) || 0;

              if (!officeStats[officeName]) {
                officeStats[officeName] = { count: 0, total: 0 };
              }

              officeStats[officeName].count++;
              officeStats[officeName].total += price;
            });

            const tbody = document.getElementById("officeSummaryBody");
            tbody.innerHTML = "";

            for (let office in officeStats) {
              let tr = document.createElement("tr");
              tr.innerHTML = `
                    <td style="padding: 10px;">${office}</td>
                    <td style="padding: 10px;">${officeStats[office].count}</td>
                    <td style="padding: 10px;">${officeStats[office].total} ุฌ.ู</td>
                `;
              tbody.appendChild(tr);
            }
          })
          .catch(err => {
            console.error("โ ูุดู ุชุญููู ููุฎุต ุงูููุงุชุจ:", err);
          });
      }

      document.addEventListener("DOMContentLoaded", loadOfficeSummary);


      document.addEventListener("DOMContentLoaded", loadTotalDailyAmount);


      // ุชุญุฏูุซ ุงูุจูุงูุงุช ูู 10 ุซูุงูู (10000 ููู ุซุงููุฉ)
      setInterval(() => {
        console.log("โป๏ธ ุชุญุฏูุซ ุงูุจูุงูุงุช...");

        // ุชุญุฏูุซ ูุงุฆูุฉ ุงูููุงุชุจ
        loadOffices();

        // ุชุญุฏูุซ ูุงุฆูุฉ ุงูููููุงุช
        loadDailyList();

        // ุชุญุฏูุซ ููุฎุต ุงูููุงุชุจ ูู ููุฌูุฏ
        if (typeof loadOfficeSummary === "function") {
          loadOfficeSummary();
        }

        // ุชุญุฏูุซ ุฅุฌูุงูู ุงูููููุงุช ูู ููุฌูุฏ
        if (typeof updateTotalDailyAmount === "function") {
          updateTotalDailyAmount();
        }

      }, 10000); // ูู 10 ุซูุงูู

      function updateTotalDailyAmount(data) {
        let total = 0;
        data.forEach(row => {
          total += Number(row.price) || 0;
        });

        document.querySelector("#totalDailyCard").textContent = "ุฅุฌูุงูู ุงูููููุงุช: " + total;
      }



    </script>

</body>

</html>
